# Device

Маршрутизация в приложении разделена на mobile и desktop сегменты. Содержимое каждого сегмента практически идентично. Сделано это, чтобы в layout каждого сегмента поместить контекст, который будет поставлять тип девайса на любой уровень дерева компонентов. При таком подходе, подавляющее число компонентов будет клиентскими, что в целом некритично, поскольку поисковая оптимизация не имеет значения для этого проекта (кроме 1ой страниц - главной). Это необходимо, чтобы не создавать динамический рендеринг страниц там, где он не нужен. За счёт динамического импорта устройство не будет скачивать файлы, которые не будут задействованы.

При создании десктопного и мобильного интерфейса не всегда можно обойтись CSS стилями. Зачастую, отличие происходит не только по визуальной части, но ещё и в функциональной. Поэтому оптимальным решением будет разделение компонента на 2 версии: декстопная и мобильная. Но этот подход имеет подводные камни. Он ведет к двоению кода. Внося изменения в одной версии, мы можем забыть о второй. Поэтому следует выносить бизнес логику в отдельное место и переиспользовать её в обоих версиях компонентов, а эти компоненты дробить как можно сильнее на подкомпоненты. Но это идеальная реализация, которую порой на практике достичь либо невозможно, либо очень и очень трудно. Её использование наиболее уместно, где веб-приложение используется либо как PWA, либо как мобильное через WebView.

В данном проекте используются следующие стратегии построения компонентов:

1. Классический (когда разделение не требуется и можно обойтись CSS)
2. Гибкий (компоненты сильно отличаются) Пример - `widgets/Header/ui/HeaderBtn/HeaderBtn.mobile.tsx` и `widgets/Header/ui/HeaderBtn/HeaderBtn.desktop.tsx`. Тип используемого компонента указывается через dot-notation в названии файла компонента, и через постфикс в названиии самого компонента (например, `HeaderBtnDesktop`). В качестве entrypoint выступает `index.ts` файл, который реэкспортирует эти компоненты. Там же можно провести переименование lazy версии компонентов `widgets/Header/ui/HeaderBtn/HeaderBtn.mobile.async.tsx` и `widgets/Header/ui/HeaderBtn/HeaderBtn.desktop.async.tsx`. Необязательно иметь обе версии компонента. Эти компоненты либо используются в головном компонент сегмента `widgets/Header/ui/Header.tsx`, либо отдаются на экспорт в public api слайса и уже используются на слоях выше.

Данный подход совмещает в себе гибкость интерфейса (например, можно в мобильной версии можно сделать Drawer, а в десктопной - Modal), упрощенную разработку (низкое количество абстракций + минимальное повторение кода) и меньшее количество затрачиваемых ресурсов (нет динамических страниц и больше клиентских компонентов, тип девайса определен на сервере и поэтому лишние ререндеры отсутсвуют (+нет промигивания поскольку тип девайса определен сразу же на первом рендере компонента)).
